<!-- Do not edit this file. It is automatically generated by API Documenter. -->

[Home](./index.md) &gt; [@microsoft/teamsfx](./teamsfx.md) &gt; [TeamsBotSsoPrompt](./teamsfx.teamsbotssoprompt.md)

## TeamsBotSsoPrompt class

> This API is provided as a preview for developers and may change based on feedback that we receive. Do not use this API in a production environment.
> 

Creates a new prompt that leverage Teams Single Sign On (SSO) support for bot to automatically sign in user and help receive oauth token, asks the user to consent if needed.

<b>Signature:</b>

```typescript
export declare class TeamsBotSsoPrompt extends Dialog 
```
<b>Extends:</b> Dialog

## Remarks

The prompt will attempt to retrieve the users current token of the desired scopes and store it in the token store.

User will be automatically signed in leveraging Teams support of Bot Single Sign On(SSO): https://docs.microsoft.com/en-us/microsoftteams/platform/bots/how-to/authentication/auth-aad-sso-bots

## Example

When used with your bots `DialogSet` you can simply add a new instance of the prompt as a named dialog using `DialogSet.add()`<!-- -->. You can then start the prompt from a waterfall step using either `DialogContext.beginDialog()` or `DialogContext.prompt()`<!-- -->. The user will be prompted to sign in as needed and their access token will be passed as an argument to the callers next waterfall step:

```JavaScript
const { ConversationState, MemoryStorage } = require('botbuilder');
const { DialogSet, WaterfallDialog } = require('botbuilder-dialogs');
const { TeamsBotSsoPrompt } = require('@microsoft/teamsfx');

const convoState = new ConversationState(new MemoryStorage());
const dialogState = convoState.createProperty('dialogState');
const dialogs = new DialogSet(dialogState);

loadConfiguration();
dialogs.add(new TeamsBotSsoPrompt('TeamsBotSsoPrompt', {
   scopes: ["User.Read"],
}));

dialogs.add(new WaterfallDialog('taskNeedingLogin', [
     async (step) => {
         return await step.beginDialog('TeamsBotSsoPrompt');
     },
     async (step) => {
         const token = step.result;
         if (token) {

             // ... continue with task needing access token ...

         } else {
             await step.context.sendActivity(`Sorry... We couldn't log you in. Try again later.`);
             return await step.endDialog();
         }
     }
]));

```

## Constructors

|  Constructor | Modifiers | Description |
|  --- | --- | --- |
|  [(constructor)(dialogId, settings)](./teamsfx.teamsbotssoprompt._constructor_.md) |  | <b><i>(BETA)</i></b> Constructor of TeamsBotSsoPrompt. |

## Methods

|  Method | Modifiers | Description |
|  --- | --- | --- |
|  [beginDialog(dc)](./teamsfx.teamsbotssoprompt.begindialog.md) |  | <b><i>(BETA)</i></b> Called when a prompt dialog is pushed onto the dialog stack and is being activated. |
|  [continueDialog(dc)](./teamsfx.teamsbotssoprompt.continuedialog.md) |  | <b><i>(BETA)</i></b> Called when a prompt dialog is the active dialog and the user replied with a new activity. |

